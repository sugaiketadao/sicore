<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PageUtil - JSDoc</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="header">
    <div class="header-content">
      <h1>PageUtil</h1>
      <p>Framework Component [onepg-utils.js]</p>
      <a href="index.html" class="back-link">‚Üê Back to Class List</a>
    </div>
  </div>
  <div class="main">
    <div class="section">
      <h2>Class Information</h2>
      <div class="class-details">
        <p><strong>Class Name:</strong> PageUtil</p>
      </div>
      <div class="class-description">
        <h3>Description</h3>
        <div>Page manipulation utility class.<br>
<ul>
  <li>Performs operations on the entire page or specified areas of the page.</li>
  <li>Performs operations such as displaying messages, checking for errors, clearing forms, enabling/disabling forms, and showing/hiding forms.</li>
  <li>Both lists (repeating rows) and details (repeating rows) are collectively called "lists". Sections explaining lists apply to both.</li>
</ul></div>
      </div>
    </div>
    <div class="section">
      <h2>Method List</h2>
      <div class="method">
        <h3 id="setMsg" class="method-name">setMsg</h3>
        <div class="method-signature">
          <code>setMsg(res)</code>
        </div>
        <div class="method-description">
          Displays messages.<br>
<ul>
  <li>Displays messages from response data.</li>
  <li>The key in response data is <code>'_msg'</code>.</li>
  <li>Elements with <code>id</code> attribute <code>'_msg'</code> become message display area elements.</li>
  <li>If multiple message display area elements exist, sets to the first element.</li>
  <li>To control display, execute <code>PageUtil#clearMsg()</code> in page initialization processing to hide.</li>
  <li>If no messages exist in response data, clears the text of the message display area element. (<code>PageUtil#clearMsg()</code> is executed)</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>res</code></td>
                <td><code>Object</code></td>
                <td>the response data</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="method">
        <h3 id="hasError" class="method-name">hasError</h3>
        <div class="method-signature">
          <code>hasError(res)</code>
        </div>
        <div class="method-description">
          Checks for error existence.<br>
<ul>
  <li>Checks for error existence from response data.</li>
  <li>The key in response data is <code>'_has_err'</code>.</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>res</code></td>
                <td><code>Object</code></td>
                <td>the response data</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="method-returns">
          <h4>Return Value</h4>
          <p><code>boolean</code> - <code>true</code> if errors exist</p>
        </div>
      </div>
      <div class="method">
        <h3 id="clearMsg" class="method-name">clearMsg</h3>
        <div class="method-signature">
          <code>clearMsg()</code>
        </div>
        <div class="method-description">
          Clears messages.<br>
<ul>
  <li>Clears the text of the message display area element.</li>
</ul>
  
        </div>
      </div>
      <div class="method">
        <h3 id="getValues" class="method-name">getValues</h3>
        <div class="method-signature">
          <code>getValues(outerElm)</code>
        </div>
        <div class="method-description">
          Gets page data.<br>
<ul>
  <li>Gets values of data-sending HTML elements (<code>&lt;input&gt;</code>, <code>&lt;select&gt;</code>, <code>&lt;textarea&gt;</code>) on the page as an associative array.</li>
  <li>HTML elements to be retrieved have the <code>name</code> attribute set, and the <code>name</code> attribute becomes the key of the associative array.</li>
  <li>If the argument retrieval range element is omitted, <code>&lt;main&gt;</code> is the retrieval range, and if <code>&lt;main&gt;</code> does not exist, <code>document.body</code> is the retrieval range.</li>
  <li>Mainly retrieves as request data to web services.</li>
  <li>The following differs from normal <code>&lt;form&gt;</code> POST submission.
  <ul>
    <li>Includes disabled items.</li>
    <li>Does not include style-hidden items (<code>display:none</code> or <code>visibility:hidden</code>).</li>
  </ul></li>
  <li>If the <code>data-value-format-type</code> attribute defining the value format type is set, gets the unformatted value with the corresponding <code>UnFrmUtil</code> method.</li>
  <li>For text boxes and text areas, gets values with tab characters, trailing blanks, and line breaks removed.</li>
  <li>For checkboxes, returns the value of the <code>value</code> attribute when checked, and gets the value of the <code>data-check-off-value</code> attribute when unchecked.</li>
  <li>List part (repeated part) data becomes an array and is stored in the associative array with one key.</li>
  <li><pre>[Example] <code>&lt;input name="user_id" value="U001"&gt;
     &lt;input name="birth_dt" value="2025/02/10"&gt;
     &lt;table&gt;...omitted...&lt;tbody id="detail"&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_no" value="1"&gt;&lt;/td&gt;
            &lt;td&gt;&lt;input name="detail.weight_kg" value="8.9"&gt;&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_no" value="2"&gt;&lt;/td&gt;
            &lt;td&gt;&lt;input name="detail.weight_kg" value="12.1"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;</code> is
      retrieved as <code>{ user_id:'U001', birth_dt:'20250210', detail:[{pet_no:'1', weight_kg:'8.9'}, {pet_no:'2', weight_kg:'12.1'}] }</code>.</pre></li>
  <li>Elements of list parts must follow the rules below.
  <ul> 
    <li>Elements within a row (hereinafter called row-internal elements) have the <code>name</code> attribute separated by <code>"."</code> and set in the format <code>tableId.itemName</code>. Note that <code>name</code> attributes separated by <code>"."</code> should only be used for row-internal elements.</li>
    <li>An element (hereinafter called table element) with the <code>id</code> attribute set to <code>tableId</code>, the part before the <code>"."</code> separator, must exist as the parent or grandparent element of row-internal elements.<br>
        In most cases, the table element is <code>&lt;tbody&gt;</code> or <code>&lt;table&gt;</code>.</li>
    <li>The child element directly under the table element must be the top-level element of the repeated part (hereinafter called row element).<br>
        In most cases, the row element is <code>&lt;tr&gt;</code>.</li>
    <li><pre>[NG Example 1] Table element does not exist. (Neither <code>&lt;table&gt;</code> nor <code>&lt;tbody&gt;</code> has the <code>id</code> attribute)
      <code>&lt;table&gt;...omitted...&lt;tbody&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;</code></pre></li>
    <li><pre>[NG Example 2] Row element does not exist directly under table element. (The <code>id</code> attribute is assigned to <code>&lt;table&gt;</code>, but <code>&lt;tbody&gt;</code> is in between)
      <code>&lt;table id="detail"&gt;...omitted...&lt;tbody&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;</code></pre></li>
    <li><pre>[OK Example 1] When the <code>id</code> attribute is assigned to <code>&lt;tbody&gt;</code>, <code>&lt;tbody&gt;</code> becomes the table element.
      <code>&lt;table&gt;...omitted...&lt;tbody id="detail"&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;</code></pre></li>
    <li><pre>[OK Example 2] When the <code>id</code> attribute is assigned to <code>&lt;table&gt;</code>, <code>&lt;table&gt;</code> becomes the table element. (Example using multiple <code>&lt;tbody&gt;</code>)
      <code>&lt;table id="detail"&gt;...omitted...
        &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;
        &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_nm"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;
      &lt;/table&gt;</code></pre></li>
  </ul></li>
  <li>Row index values are stored in row-internal elements as the <code>data-obj-row-idx</code> attribute, and they are converted to arrays based on that index.</li>
  <li>For radio buttons within rows, removes the [row index] at the end of the <code>name</code> attribute to use as the return value key. (See <code>PageUtil#setValue</code>)</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>[outerElm]</code></td>
                <td><code>Object</code></td>
                <td>Retrieval range element (optional)</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="method-returns">
          <h4>Return Value</h4>
          <p><code>Object</code> - Page data associative array (unformatted)</p>
        </div>
      </div>
      <div class="method">
        <h3 id="getRowValues" class="method-name">getRowValues</h3>
        <div class="method-signature">
          <code>getRowValues(rowElm)</code>
        </div>
        <div class="method-description">
          Gets row data.<br>
<ul>
  <li>Gets page data of one row in a list as an associative array.</li>
  <li>Data retrieval rules are the same as <code>PageUtil#getValues</code>.</li>
  <li>The part before <code>"."</code> in the <code>name</code> attribute (= the <code>id</code> attribute of the table element) is removed to become the key of the associative array.</li>
  <li><pre>[Example] When the second row of <code>&lt;table&gt;...omitted...&lt;tbody id="detail"&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_no" value="1"&gt;&lt;/td&gt;
            &lt;td&gt;&lt;input name="detail.weight_kg" value="8.9"&gt;&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;&lt;input name="detail.pet_no" value="2"&gt;&lt;/td&gt;
            &lt;td&gt;&lt;input name="detail.weight_kg" value="12.1"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;</code> is specified as an argument,
      <code>{ pet_no:'2', weight_kg:'12.1' }</code> is retrieved.</pre></li>
  <li>For radio buttons within rows, removes the [row index] at the end of the <code>name</code> attribute to use as the return value key. (See <code>PageUtil#setValues</code>)</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>rowElm</code></td>
                <td><code>Element</code></td>
                <td>Row element (typically <code>&lt;tr&gt;</code>)</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="method-returns">
          <h4>Return Value</h4>
          <p><code>Object</code> - Row data associative array (unformatted)</p>
        </div>
      </div>
      <div class="method">
        <h3 id="getRowValuesByInnerElm" class="method-name">getRowValuesByInnerElm</h3>
        <div class="method-signature">
          <code>getRowValuesByInnerElm(baseElm, rowTag)</code>
        </div>
        <div class="method-description">
          Gets row data.<br>
<ul>
  <li>Traverses parent elements from the argument base element to get the row element (typically <code>&lt;tr&gt;</code>), and gets the page data of that row element as an associative array.</li>
  <li>Data retrieval rules are the same as <code>PageUtil#getRowValues</code>.</li>
</ul> 
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>baseElm</code></td>
                <td><code>Element</code></td>
                <td>Base element</td>
              </tr>
              <tr>
                <td><code>[rowTag]</code></td>
                <td><code>string</code></td>
                <td>Tag name of row element (optional) Defaults to 'tr' if omitted</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="method-returns">
          <h4>Return Value</h4>
          <p><code>Object</code> - Row data associative array (unformatted)</p>
        </div>
      </div>
      <div class="method">
        <h3 id="setValues" class="method-name">setValues</h3>
        <div class="method-signature">
          <code>setValues(obj, outerElm)</code>
        </div>
        <div class="method-description">
          Sets page data.<br>
<ul>
  <li>Sets values from an associative array to HTML elements on the page.</li>
  <li>HTML elements to be set must have the <code>name</code> attribute or <code>data-name</code> attribute, and the key of the associative array becomes the value destination <code>name</code> attribute or <code>data-name</code> attribute.</li>
  <li>For elements other than input form elements (which originally do not have the <code>name</code> attribute) such as <code>&lt;span&gt;</code> or <code>&lt;td&gt;</code>, sets the <code>data-name</code> attribute.</li>
  <li>For HTML elements that do not have the <code>value</code> attribute such as <code>&lt;span&gt;</code> or <code>&lt;td&gt;</code>, sets to <code>textContent</code>.</li>
  <li>If the argument set range element is omitted, <code>&lt;main&gt;</code> is the set range, and if <code>&lt;main&gt;</code> does not exist, <code>document.body</code> is the set range.</li>
  <li>Mainly sets response data from web services.</li>
  <li>Keys of the associative array starting with underscore are values used by this framework and cannot be used from outside this class, so they are ignored in this method.</li>
  <li>If the <code>data-value-format-type</code> attribute defining the value format type is set, sets the value formatted with the corresponding <code>FrmUtil</code> method.</li>
  <li>List part data is assumed to be stored as an array in one key within the associative array.</li>
  <li><pre>[Example] <code>{ user_id:'U001', birth_dt:'20250210', list:[{pet_no:'1', weight_kg:'8.9'}, {pet_no:'2', weight_kg:'12.1'}] }</code> is
    set as <code>&lt;input name="user_id" value="U001"&gt;
    &lt;input name="birth_dt" value="2025/02/10"&gt;
    &lt;table&gt;...omitted...&lt;tbody id="detail"&gt;
      &lt;tr&gt;&lt;td data-name="detail.pet_no"&gt;1&lt;/td&gt;
          &lt;td&gt;&lt;input name="detail.weight_kg" value="8.9"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;tr&gt;&lt;td data-name="detail.pet_no"&gt;2&lt;/td&gt;
          &lt;td&gt;&lt;input name="detail.weight_kg" value="12.1"&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;/tbody&gt;&lt;/table&gt;</code>.</pre></li>
  <li>Rules for table elements, row elements, and row-internal elements within lists are the same as <code>PageUtil#getValues</code>.</li>
  <li>To link and display the number of arrays in the associative array with the number of rows in the list, dynamically generates elements from the template row element (hereinafter called template row element) and sets values.</li>
  <li>The template row element is placed at the child element (top) of the table element, enclosed in <code>&lt;script&gt;</code>.</li>
  <li><pre>[Example] In the case of the above example, place the template row element as follows.
    <code>&lt;table&gt;...omitted...&lt;tbody id="detail"&gt;
      &lt;script type="text/html"&gt;&lt;tr&gt;&lt;td data-name="detail.pet_no"&gt;&lt;/td&gt;
                                   &lt;td&gt;&lt;input name="detail.weight_kg"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/script&gt;
    &lt;/tbody&gt;&lt;/table&gt;</code></pre></li>
  <li>Radio buttons within template row elements have [row index] appended to the end of the <code>name</code> attribute to group them per row.</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>obj</code></td>
                <td><code>Object</code></td>
                <td>Associative array data</td>
              </tr>
              <tr>
                <td><code>[outerElm]</code></td>
                <td><code>Element</code></td>
                <td>Set range element (optional) If omitted, <code>document.body</code> is the target</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="method">
        <h3 id="addRow" class="method-name">addRow</h3>
        <div class="method-signature">
          <code>addRow(listId, obj)</code>
        </div>
        <div class="method-description">
          Adds list row.<br>
<ul>
  <li>Generates and adds a row element with the template row element of the table element and sets default values.</li>
  <li>For template rows, see <code>PageUtil#setValues</code>.</li>
  <li><pre>[Example] In the case of the template row below.
    <code>&lt;table&gt;...omitted...&lt;tbody id="detail"&gt;
      &lt;script type="text/html"&gt;&lt;tr&gt;&lt;td data-name="detail.pet_no"&gt;&lt;/td&gt;
                                   &lt;td&gt;&lt;input name="detail.weight_kg"&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/script&gt;
    &lt;/tbody&gt;&lt;/table&gt;</code>
    Keys of default values are as follows, excluding the table element <code>id</code> attribute (detail.).
   <code>{ pet_no:'1', weight_kg:'8.9' }</code>
   If an array of associative arrays is passed, multiple rows are added.
   <code>[ { pet_no:'1', weight_kg:'8.9' }, { pet_no:'2', weight_kg:'12.1' } ]</code></pre>
  </li>
  <li>If default values are omitted, adds one empty row element.</li>
  <li>To add multiple empty rows, pass <code>new Array(n)</code>.</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>listId</code></td>
                <td><code>string</code></td>
                <td><code>id</code> attribute of table element (parent element) ([Example] <code>'detail'</code>)</td>
              </tr>
              <tr>
                <td><code>[obj]</code></td>
                <td><code>Object|Array&lt;Object&gt;</code></td>
                <td>Default value associative array when adding row (optional)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="method">
        <h3 id="removeRow" class="method-name">removeRow</h3>
        <div class="method-signature">
          <code>removeRow(searchElmName, searchElmVal, rowTag)</code>
        </div>
        <div class="method-description">
          Removes list row.<br>
<ul>
  <li>Removes the row element (typically <code>&lt;tr&gt;</code>) that contains an element with the specified <code>name</code> attribute and <code>value</code> attribute.</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>searchElmName</code></td>
                <td><code>string</code></td>
                <td><code>name</code> attribute of search target element ([Example] For checkboxes <code>'detail.chk'</code>) <code>data-name</code> attribute is not allowed</td>
              </tr>
              <tr>
                <td><code>searchElmVal</code></td>
                <td><code>string</code></td>
                <td>Value of search target element ([Example] <code>'1'</code>)</td>
              </tr>
              <tr>
                <td><code>[rowTag]</code></td>
                <td><code>string</code></td>
                <td>Tag name of row element (optional) Defaults to <code>'tr'</code> if omitted</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="method-returns">
          <h4>Return Value</h4>
          <p><code>boolean</code> - <code>true</code> on successful removal</p>
        </div>
      </div>
      <div class="method">
        <h3 id="clearRows" class="method-name">clearRows</h3>
        <div class="method-signature">
          <code>clearRows(listId)</code>
        </div>
        <div class="method-description">
          Deletes all rows.<br>
<ul>
  <li>Removes all row elements except the template row.</li>
</ul>
        </div>
        <div class="method-parameters">
          <h4>Parameters</h4>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>listId</code></td>
                <td><code>string</code></td>
                <td><code>id</code> attribute of table element (parent element) ([Example] <code>'detail'</code>)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <p>Generated by JSDocGenerator - 2026</p>
  </div>
</body>
</html>
